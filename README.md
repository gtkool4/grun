<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# Package grun

`grun` wraps the gtk application startup process with flexible settings.

`New` and `Set` applies `Params` to configure `App.App` and `Win`.

`Run` launches `Exec` to work on lists of Actions.

`Actions` can be any function with allowed arguments and returns, or lists of functions ([]func, map[string]func). Recursion is possible (lists in lists).

* Arguments:  none, App
* Returns:    none, gtk.Widgetter, error, Errors,
              (gtk.Widgetter, error), (gtk.Widgetter, Errors)

So you can choose and edit your function parameters as you need.

## Hello World

```
func main() { gapp.Run() }

var gapp = grun.App{
	ID:     "com.github.gtkool4.hello.World",
	Title:  "Hello world",
	Width:  400,
	Height: 400,
	OnRun:  func() gtk.Widgetter { return gtk.NewLabel("Hello gotk4!") },
}


```

## Testable Proposal for the go gtk4 startup process level 2 API

This package is a running example of a proposal to become the advised way to run GTK4 applications. It intends to have a fast and clean declaration for apps and flexible behavior for tests.

Warning, this is an early discussion mode topic, so the code is subject to brutal change at any moment. So if you find this version perfect, make backups :) .

Disclaimer, please forgive me for every spelling, grammar or other mistake in that doc as english is not my first language.

## Goals

What this package tries to do:

* Gather clean settings declaration at the top of the file for apps.
* Easy to start with a one liner main that requires no testing.
* Hide the gtk.Application callback management and its basic needs:
  Create app, connect callbacks, create window, set size, set title,
  pack widget, show window, save pointers...
* Usage
  * Can change between headless and with window.
  * Can change between auto-close or not.
  * Set those globally or locally.
  * Do those changes easily (commenting preferred).
  * No huge params list on functions.
  * Short and readable (minimum boilerplate, and edits for tests).


In summary, it should reduce at most the app startup process, especially for tests files that could have a lot of window creations.

Bonus: It should be pretty easy to work with lists of interfaces. You can call Run with almost any kind of usable func (let us know what's missing). And Actions allow recursion to customize any kind of crazy config.

There's much more to discover in the examples.

## Todo

* App.App open signal to open files from the command line or gui.
* ForceWindowInSingleTest Param: Need to detect if we're running a single
  or package test to auto-toggle the show window.

## FEEDBACK - Evolution - Options - Need tests, comments and ideas

Please test it and let us know if it was usable, or if you think some things could be improved, especially naming.

This package, or an evolution of it, could remain mainstream as standalone or be integrated besides the libs, to help all gtk users start their programs so feedback will be really appreciated.

Options (ideas possible to implement): 

  * Change OnStart callback to return an error. I feel this will mostly be used
    to LoadConfig() and/or InitDB() so an error/exit management would be nice.
  * MultiWindow flag: Allow any widget provided to open a window (at startup or later)
  * Rename Run to Go ?
  * Package name ideas:
     *grun      Go/Gtk Run          My best candidate so far. Run is the package main call.
     *gruntk    Run Gtk or reverse  Long for repetitive test typing.
    * napp      New App             A nice option, but I think grun is better.
    * appinfo   Application Info    Nice but a little long for repetitive calls
    * gtg       Good To Go          I liked this idea a lot but it would be confusing with gtk in test files.

## Vocabulary

This documentation tries to always use the same term to talk about the same things, for clarity.

List of terms defined for this documentation:

```
App            This package App object.
App.App        The *gtk.Application object pointer.
Action(s)      Any kind of usable function/closure/method, or list of.
               Usable on Run and after with Exec
Exec           Parse and calls Actions on Run and after.
GoExitCode     ExitCode returned from the go application.
GtkExitCode    App.App returned value. Used as App return value if > 0.
Param(s)       Setting(s) to apply before Run.
Run            App.App startup process with Exec.
Win            The *gtk.Window object pointer.
```

## Usage

`New` creates the `App` object or it can be created manually.

`Run` starts the `App`, blocking the main go loop until `App` is exited when the last connected window is closed or an exit was requested:

```
gapp := grun.NewSized(400, 200, Params...)
gapp.Run(Actions...)
```

## Parameters functions

Params and Actions are parameters functions which mean they are functions prepared to be called later. This has to be reminded as some things aren't always ready when the functions are created.

So Params and Actions are a list of prepared calls that will be executed in the provided order.

## Actions

List of types usable with Run or Exec:
```
With widget for the window.
  func() gtk.Widgetter               // Simple with widget.
  func() (gtk.Widgetter, error)      // The same with errors.
  func() (gtk.Widgetter, Errors)     // buildhelp (gtk.Builder) errors list.
  func(*App) gtk.Widgetter           // To act on App or Win object.
  func(*App) (gtk.Widgetter, error)  // ...

Headless.
  func()                   // Simple func or closure.
  func() error             // With error testing.
  func(*App)               // To act on App or Win object.
  func(*App) error         // ...
  func() func(*App)        // In case the Action is wrapped.

Lists.
  []interface{}            // Recursive list of any handled type.
  map[string]interface{}:  // Warning, execution order from a map is random.
                           // This is mostly for tests and serial queuing.

String as label window (for tests)
  string                   // Display a string.
  func() string            // Or a returned string.
  func(*AppInfo) string    // ...
```

## Callbacks

With the advice to use application in GTK, callbacks are now our also our applications main entry point.

They run in this order:

```
- OnInit           Optional (logger, config and DB init for example)
- OnRun            Where all the work is done, and/or in the Run arguments.
  - Exec           Launch Actions.
                   If an Action can create a widget:
                     Create and configure the window.
                     Create the widget.
                     Pack the widget if it's not nil and show the window.
                   If errors are returned, Stop.
- ..........       Application running........
- OnStop           Optional.
```

### Notes

* Actions set in OnRun are called before those provided in the Run call to
  allow global actions before local actions
* Only one window will be created with the first valid widget found (so there will be something to put inside).
* The returned exit code is the first positive between GtkExitCode and GoExitCode (use the ExitCode method for GoExitCode).
* The returned exit code can be used with os.Exit but that prevents any defer calls from running. Use at your own risks.
